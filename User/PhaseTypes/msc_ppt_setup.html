<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="preload" as="image" href="../../collector-experiments/User/Assets/MSc/swear-disinhibition-zoom.svg">
    <link rel="stylesheet" href="../../collector-experiments/User/Assets/MSc/global_css.css">
    <link rel="stylesheet" href="../../collector-experiments/User/Assets/MSc/radio_buttons.css">
    <style>
      /*************************/
      /* STLYING THE PAGE TABS */
      /*************************/
      
      /* This clears all formatting from the buttons to begin */
      button, input[type="submit"], input[type="reset"] {
      	background: none;
      	color: inherit;
      	border: none;
      	padding: 0;
      	font: inherit;
      	cursor: pointer;
      	outline: inherit;
      }
      #proceed_button, #prevBtn, #nextBtn {
        margin: auto;
        color: #FFF;
        background-color: #006599;
        border-color: #006599;
        font-weight: 400;
        line-height: 1.5;
        text-align: center;
        vertical-align: middle;
        padding: .375rem .75rem;
        font-size: 1rem;
        border-radius: .25rem;
      }
      #prevBtn:hover, #nextBtn:hover, #nextBtn.submitBtn_active:hover {
        background-color: #275fda;
      }
      #nextBtn.submitBtn {
        pointer-events: none;
        background-color: #a1d4ee;
        border-color: #a1d4ee;
      }

      #nextBtn.submitBtn_active {
        background-color: #006599;
      }
      /* Style the input fields */
      input {
        padding: 10px;
        width: 100%;
        border: 1px solid #aaaaaa;
      }
      
      /* Mark input boxes that gets an error on validation: */
      input.invalid {
        background-color: #ffdddd;
      }
      
      /* Hide all steps by default: */
      .tab {
        display: none;
      }
      
      /* Make circles that indicate the steps of the form: */
      .step {
        height: 15px;
        width: 15px;
        margin: 0 2px;
        background-color: #bbbbbb;
        border: none;
        border-radius: 50%;
        display: none;
        opacity: 0.5;
      }
      
      /* Mark the active step: */
      .step.active {
        opacity: 1;
      }
      
      /* Mark the steps that are finished and valid: */
      .step.finish {
        background-color: #04AA6D;
      }
      
      /* ******************** */
      /* CONTINUE BTN MESSAGE */
      /* ******************** */
      .tooltipCon {
        position: relative;
        display: inline-block;
      }
      
      .tooltipHidden {
        visibility: hidden;
        position: absolute;
        display: inline-block;
        width:600px;
      }
      
      .tooltipCon .tooltiptext {
        visibility: hidden;
        width: 450px;
        background-color: #006599;
        color: #fff;
        text-align: center;
        border-radius: 6px;
        padding: 5px 0;
      
        /* Position the tooltip */
        position: absolute;
        z-index: 1;
        bottom: 45px;
        right: -180px;
      }
      
      .tooltipCon:hover .tooltiptext {
        visibility: visible;
      }
      
      .tooltipCon .tooltiptext::after {
        content: "";
        position: absolute;
        top: 100%;
        left: 50%;
        margin-left: -5px;
        border-width: 5px;
        border-style: solid;
        border-color: #006599 transparent transparent transparent;
      }
      
      /********************/
      /* STLYING THE FORM */
      /********************/
      
      /* The container */
      .formLabel {
        position: relative;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
        display: block;
      }
      
      #birthMonth, #mobileNumber, #surnameVowel {
        margin: 10px 0;
        padding: 10px;
        width: 20%;
        border: 1px solid #e6e6e6;
        background-color: #FFF;
      }
      
      #birthMonth:hover, #mobileNumber:hover, #surnameVowel:hover {
        border-color: #006599;
        width: 20%;
      }
      
      #birthMonth:hover, #surnameVowel:hover {
        cursor: pointer;
      }
      
      #birthMonth:focus, #mobileNumber:focus, #surnameVowel:focus {
        outline: none !important;
        border:1px solid #006599;
        box-shadow: 0 0 2px #719ECE;
        cursor: pointer;
      }
      
      .idMsg {
        margin-bottom: 40px;
        margin-top: -20px;
      }
      
      .idMsg p {
        margin-left: 40px;
      }
      
      #idMsgIcon {
        width: 30px;
        height: 30px;
        transform: translateY(6px);
      }
      
      /**********/
      /* BORDER */
      /**********/
      
      #scaleBorder{
        width: 600px;
        height: 750px;
        border: 7px solid black;
        border-radius: 15px;
        display: flex;
        justify-content: flex-start;
        margin: 0 auto;
        position: relative;
        align-items: center;
        flex-direction: column;
      }
      #zoomImg {
        padding: 14px;
        display: inline;
        width: 165px;
        transform: translateY(20px);
      }
      
      #zoomTab {
        display:flex;
        justify-content: center
        } 
      #zoomTab p {
        padding: 40px;
        margin-top: -5px;
        text-align: center;
        font-size: 19.9px;
        /*font-weight: bold;*/
      }
      
      #formButtons {
        padding-top: 50px;
        clear: both;
      }
      
      /*************************/
      /* STYLING RADIO BUTTONS */
      /*************************/
      
      hr {
        transform: translateY(-10px);
      }
      
    </style>
 </head>
 <body>
    <input type="hidden" id="uniqueid" name="uniqueid" />
    <input type="hidden" id="testingsession" name="testingsession" />
    <button id="zoomOut" class="zoomBtn" tabindex="-1"></button>
    <button id="zoomIn" class="zoomBtn" tabindex="-1"></button>
    <div id="container">
      <form id="regForm" action="">
        <!-- ------------------------ -->
        <!-- This is the Scale Setup  -->
        <!-- ------------------------ -->
        
        <div id="zoomTab" class="tab">
          <div id="scaleBorder">
            <img id="zoomImg" src="../../collector-experiments/User/Assets/MSc/swear-disinhibition-zoom.svg" />
            <p><span style="font-weight:bold;">Let's Check If Everything Fits Your Screen...</span><br><br>This box represents the size of the largest task that will appear on screen during the study. <br><br> Most participants shouldn't need to adjust anything but, if the outside black border extends off your screen, please use the 'zoom in' and 'zoom out' buttons in the top left-hand corner of the screen to adjust the scaling until the border around this box is completely visibile.<br><br>Any adjustments should remain across the experiment, but if you feel it needs readjusting, the zoom buttons will be in the top left-hand corner of most pages. <br><br>When you are ready, please click 'Next' below.</p>
          </div>
        </div>
        
        <!-- -------------------- -->
        <!-- This is the ID Setup -->
        <!-- -------------------- --> 
        
        <div class="tab">
          <h2><b>Your Participant ID</b></h2>
          <hr>
          <b>Firstly, thank you for setting your zoom level.</b> As mentioned, if you need to adjust it later on, the zoom buttons will appear on most pages. They are sometimes unavailable if we need to control the specific size of the text on the screen (i.e., to ensure consistency across participants when presenting certain task stimuli). <br><br>The next task before the experiment can begin is to enter your uniquie participant ID. This is required so we can track your data across all three testing sessions. Please follow the instructions below:<br><br>
          <div id="consentForm">
            <label class="formLabel">Using the dropdown menu, please select your birth month</label>
              <select id="birthMonth">
                <option value="" disabled selected>Select a month</option>
                <option value="r">January</option>
                <option value="w">February</option>
                <option value="t">March</option>
                <option value="v">April</option>
                <option value="h">May</option>
                <option value="y">June</option>
                <option value="k">July</option>
                <option value="j">August</option>
                <option value="n">September</option>
                <option value="s">October</option>
                <option value="z">November</option>
                <option value="b">December</option>
              </select>
            </label>
            <label class="formLabel">Please enter the last 4 digits of your mobile number:<br></label>
            <input type="text" id="mobileNumber" placeholder="last 4 digits only" maxlength="4" oninput="this.value = this.value.replace(/[^0-9.]/g, '').replace(/(\..*)\./g, '$1');" /><br>
            <label class="formLabel">Using the dropdown menu, please select the first vowel in your surname <br><em><span style="color:#808080;">(If your surnames doesn't contain any vowels, please select 'A')</span></em></label>
              <select id="surnameVowel">
                <option value="" disabled selected>Select a vowel</option>
                <option value="z">A</option>
                <option value="v">E</option>
                <option value="t">I</option>
                <option value="d">O</option>
                <option value="y">U</option>
              </select>
            </label>
          <!--</div>-->
          <br>
          <img id="idMsgIcon" src="../../collector-experiments/User/Assets/MSc/idNeg.svg" /><div class="idMsg"><p>Your Participant ID is: <b><span id="value"></span></b></p><span style="font-size:14px;"><em>Please make a note of it as you will need to quote it in any communication with the researchers.</em></span><br></div>
          <div class="radiogroup">
          <hr>
          <p>Finally, please can you indicate which testing session you are completing today by selecting an option below</p>
            <label id="radioLabelHolder" class="radioHide"><input type="radio" class="option-input radio checked" name="sessionnumber" id="sessionnumber" value="1"/><span class="radioLabel">First</span></label>
            <label id="radioLabelHolder" class="radioHide"><input type="radio" class="option-input radio" name="sessionnumber" id="sessionnumber" value="2" /><span class="radioLabel">Second</span></label>
            <label id="radioLabelHolder" class="radioHide"><input type="radio" class="option-input radio" name="sessionnumber" id="sessionnumber" value="3" /><span class="radioLabel">Third</span></label>
          </div></div>
        </div>
        <div>
          <div>
            <!-- Circles which indicates the steps of the form: -->
            <div id="formButtons" style="text-align:center;">
              <span class="step"></span>
              <span class="step"></span>
            <div></div>
            <button type="button" id="prevBtn" onclick="nextPrev(-1)">Previous</button>
              <div id="tooltipCon" class="tooltipCon">
                <button type="button" id="nextBtn" onclick="nextPrev(1)">Next</button>
                <span id="tooltiptext" class="tooltipHidden">Sorry. Your Participant ID is not correctly formatted.<br/><em>(have you entered the last 4 digits of your mobiel number?)</em></span>
              </div>
          </div>
        </div>

      </form>
    </div>
    <!-- --------------------------------- -->
    <!-- Only Javascript beyond this point -->
    <!-- --------------------------------- -->
    <script>
    
      function appropriate_message(this_message) { // This just sets up a popup message that doesn't break full screen
          bootbox.alert(this_message);
      }
      var preScreen = "{{task_body_text}}";
      function display_sessionnumber() {
        if (preScreen == "Pre_Screen") {
          // appropriate_message("goodbye")
        	$('.radiogroup').hide();
        	$('#formButtons').css('transform', 'translateY(10px)');
        	$(".checked").prop('checked',true);
        } else {
          // appropriate_message("Hello");
        }
      }
    //---------------------//
    // COLLECTING ID VALUE //
    //---------------------//
      
    var idChar = document.getElementById("birthMonth");
    var idNum = document.getElementById("mobileNumber");
    var idVow = document.getElementById("surnameVowel");
    var output = document.getElementById("value");
    var session = document.getElementById("sessionnumber");
    
    var idForm = document.getElementById("consentForm");
    idForm.onchange = function() {
      parent.parent.sessionnumber = $('input[name="sessionnumber"]:checked').val();
      parent.parent.pptID = idChar.value + idNum.value + idVow.value;
        if (parent.parent.pptID.length > 5 && $('input:radio[name="sessionnumber"]').is(':checked')) {
          document.getElementById("nextBtn").setAttribute("class", "submitBtn_active");
          document.getElementById("tooltiptext").setAttribute("class", "tooltipHidden");
          output.innerHTML = parent.parent.pptID
          document.getElementById("idMsgIcon").src="../../collector-experiments/User/Assets/MSc/idPos.svg";
          document.getElementById("uniqueid").value = parent.parent.pptID;
          document.getElementById("testingsession").value = parent.parent.sessionnumber;
          console.log($('input[name="sessionnumber"]:checked').val());
        } else if (parent.parent.pptID.length > 5 && $('input:radio[name="sessionnumber"]').not(':checked')) {
          document.getElementById("nextBtn").setAttribute("class", "submitBtn");
          document.getElementById("tooltiptext").setAttribute("class", "tooltiptext");
          document.getElementById("tooltiptext").innerHTML = "Please complete the form above by indicating which testing session you are completing today</em>";
          output.innerHTML = parent.parent.pptID
          document.getElementById("idMsgIcon").src="../../collector-experiments/User/Assets/MSc/idPos.svg";
          document.getElementById("uniqueid").value = parent.parent.parent.parent.pptID;
        } else {
          document.getElementById("tooltiptext").setAttribute("class", "tooltiptext");
          document.getElementById("nextBtn").setAttribute("class", "submitBtn");
          document.getElementById("idMsgIcon").src="../../collector-experiments/User/Assets/MSc/idNeg.svg";
          document.getElementById("tooltiptext").innerHTML = "Sorry. Your Participant ID is not correctly formatted.<br/><em>(have you entered the last 4 digits of your mobiel number?)";
          output.innerHTML = "";
        }
         if (preScreen == "Pre_Screen") {
          document.getElementById("testingsession").value = 0;
        }
    }
    //-----------------//
    // PAGE TABS STUFF //
    //-----------------//
      
      var checkBox = document.getElementById("consent");  
      var currentTab = 0; // Current tab is set to be the first tab (0)
      showTab(currentTab); // Display the current tab
      
      function showTab(n) {
        // This function will display the specified tab of the form...
        var x = document.getElementsByClassName("tab");
        x[n].style.display = "block";
        //... and fix the Previous/Next buttons:
        if (n == 0) {
          document.getElementById("prevBtn").style.display = "none";
        } else {
          document.getElementById("prevBtn").style.display = "inline";
        }
        if (n == (x.length - 1)) {
          document.getElementById("nextBtn").innerHTML = "Continue";
          document.getElementById("nextBtn").setAttribute("class", "submitBtn");
          document.getElementById("tooltiptext").setAttribute("class", "tooltiptext");
        } else {
          document.getElementById("nextBtn").innerHTML = "  Next  ";
          document.getElementById("nextBtn").setAttribute("class", "submitBtn_active");
        }
        //... and run a function that will display the correct step indicator:
        fixStepIndicator(n)
      }
      
        //$(".good-form > .actions a, .theButton").addClass('disabled');
        function nextPrev(n) {
          var x = document.getElementsByClassName("tab");
          if (n == 1 && !validateForm()) return false;
          x[currentTab].style.display = "none";
          currentTab = currentTab + n;
          if (currentTab >= x.length) {
            Phase.submit()
          }
          showTab(currentTab);
        }
      
      
      $("#prevBtn").click(function() {
        document.getElementById("regForm").reset();
        output.innerHTML = "";
        document.getElementById("tooltiptext").setAttribute("class", "tooltipHidden");
      });
      
      // Scroll Back To Top
      $("#nextBtn").click(function() {
        document.getElementById("idMsgIcon").src="../../collector-experiments/User/Assets/MSc/idNeg.svg";
        display_sessionnumber()
      });
      
      // Scroll Back To Top
      $("#nextBtn, #prevBtn").click(function() {
  	    $(window).scrollTop(0);
      });
      
      
      function validateForm() {
        // This function deals with validation of the form fields
        var x, y, i, valid = true;
        x = document.getElementsByClassName("tab");
        y = x[currentTab].getElementsByTagName("input");
        // A loop that checks every input field in the current tab:
        for (i = 0; i < y.length; i++) {
          // If a field is empty...
          if (y[i].value == "") {
            // add an "invalid" class to the field:
            y[i].className += " invalid";
            // and set the current valid status to false
            valid = false;
          }
        }
        // If the valid status is true, mark the step as finished and valid:
        if (valid) {
          document.getElementsByClassName("step")[currentTab].className += " finish";
        }
        return valid; // return the valid status
      }
      
      function fixStepIndicator(n) {
        // This function removes the "active" class of all steps...
        var i, x = document.getElementsByClassName("step");
        for (i = 0; i < x.length; i++) {
          x[i].className = x[i].className.replace(" active", "");
        }
        //... and adds the "active" class on the current step:
        x[n].className += " active";
      }
    </script>
    <script src="../../collector-experiments/User/Assets/MSc/zoom_script.js"></script>
 </body>
</html>