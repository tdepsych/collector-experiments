<!--'lop_trials' PhaseTypes-->
<script src="../../collector-experiments/User/Assets/Global/js/detect_mobile.js"></script>
<link rel="stylesheet" href="../../collector-experiments/User/Assets/Global/css/global_css.css">
<style>
  /* General Styling
   ******************/
  
  body{
    background-color:white;
    overflow: hidden;
  } 
  #instruction{
    background-color:transparent;
    color:black;
    cursor: default;
    font-size:40px;
    display: block;
    position: relative;
    z-index: 1;
  }
  #ready{
    background-color:transparent;
    color:black;
    cursor: default;
    font-size:40px;
    display: block;
    position: relative;
    z-index: 2;
  }
  #response_buttons{
    display: block;
    position: relative;
    z-index: 5;
    top: 100px;
  }
  #word{
    background-color:transparent;
    color:black;
    cursor: default;
    font-size:40px;
    text-transform: uppercase;
    display: block;
    position: relative;
    z-index: 3;
  }
  #No {
    background-color: transparent;
    background-image: url(../../collector-experiments/User/Assets/LOP/no.svg);
    background-repeat: no-repeat;
    background-position: 50% 50%;
    transform: translateX(-150px) scale(450%);
    border: none;
    opacity: 0.25;
    color: transparent;
    display: inline-block;
  }
  #Yes {
    background-color: transparent;
    background-image: url(../../collector-experiments/User/Assets/LOP/yes.svg);
    background-repeat: no-repeat;
    background-position: 50% 50%;
    transform: translateX(140px) scale(450%);
    border: none;
    opacity: 0.25;
    color: transparent;
    display: inline-block;
  }
  #No:hover, #Yes:hover {
        opacity: 1;
  }
    
  /* Spinner Styling 
   *******************/
   
  #spinner {
    width: 10rem;
    height: 10rem;
    border-width: 10px;
  }
  
  /* Mobile Styling
   ******************/
   
  #No.button_response.mobile {
    background-color: transparent;
    background-image: url(../../collector-experiments/User/Assets/LOP/no.svg);
    background-repeat: no-repeat;
    background-position: 50% 50%;
    transform: translate(-1250%, -85%) scale(450%);
    border: none;
    display:none;
    color: transparent;
    opacity: 1;
  }
  #Yes.button_response.mobile {
    background-color: transparent;
    z-index: 0;
    background-image: url(../../collector-experiments/User/Assets/LOP/yes.svg);
    background-repeat: no-repeat;
    background-position: 50% 50%;
    transform: translate(1250%, -85%) scale(450%);
    border: none;
    display:none;
    color: transparent;
    opacity: 1;
  }
</style>
<input type='hidden' id='keyboard_response' name='keyboard_response' value="-1"/>
<input type='hidden' id='lop_rt' name='lop_rt'/>
<div id='container'>
  <div id='instruction'>{{text}}</div>
  <div id='ready'>Ready?</div>
  <div id='word'><b>{{word}}</b></div>
  <div id='response_buttons'>
    <input id='No' class='button_response' type='button' value='0'/>
    <input id='Yes' class='button_response' type='button' value='1'/>
  </div>
  <div id="spinner" class="spinner-border text-primary" role="status">
    <span class="sr-only"></span>
  </div>
</div>
<script>

  // If mobile assign a new class
  if(isMobile.any()) {
    $('#Yes').addClass('mobile');
    $('#No').addClass('mobile');
  }
  
  // This is replaces Phase.elapsed() for working out RTs
  var baselineTime = '';
  Phase.set_timer(function() {
    rawTime = (new Date()).getTime(); 
    baselineTime = rawTime + 3000;
    console.log("Baseline: " + baselineTime);
  },0);
  
  // This just monitors for a response click and ends the trial
  $('.button_response').click(function(){
    var class_list = this.className.split(' ');
    var end_trial = false;
    if(class_list.indexOf('end_trial') !== -1){
      end_trial = true;
    }
    class_list.splice(class_list.indexOf('end_trial'),1);
    class_list.splice(class_list.indexOf('button_response'),1);
    $('input[name = "' + class_list + '"]').val(this.value);
    if(end_trial){
      Phase.submit();
    }
  });
  
  // This controls the hiding/showing of text as each trial progresses
  $('#ready, #word, #response_buttons, #spinner').hide()     // start by hiding everything
  Phase.set_timer(function(){$('#instruction').hide()},'1500');         //Phase.set_timer is a Collector function required because of buffering (which prevents the use of setTimeout) 
  Phase.set_timer(function(){$('#ready').show()},'1500');
  Phase.set_timer(function(){$('#ready').hide()},'2500');
  Phase.set_timer(function(){$('#word').show()},'2500');
  Phase.set_timer(function(){
    $('#response_buttons').show()
    $('#word').css('transform', 'translateY(13px)') // This just adjusts the position of the word so it doesn't appear to move when the buttons appear
  },'3000');
  Phase.set_timer(function(){$('#word').hide()},'7000');
  Phase.set_timer(function(){$('#Yes, #No').hide()},'7000');
  
  var responseTime = '';
  var rtTime = '';
  
  $('.button_response').click(function(){
    responseTime = (new Date()).getTime() 
    rtTime =  responseTime - baselineTime
    console.log("RT: " + rtTime);
    if (this.id == 'Yes') {
      document.getElementById("lop_rt").value = rtTime;
      $("#keyboard_response").val("1");  
    } else {
      document.getElementById("lop_rt").value = rtTime;
      $("#keyboard_response").val("0");  
    }
    $('#Yes').hide();
    $('#No').hide();
    $('#word').hide();
    $('#spinner').show();
    setTimeout(function(){
      Phase.submit()
    },2000);
  });
</script>